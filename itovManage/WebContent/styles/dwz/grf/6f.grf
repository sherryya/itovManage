Object Report
	Version='6.0.0.2'
	Title='6f.发票成批套打'
	Author='锐浪报表软件'
	Description='演示发票成批套打。\r\n1、定义一个分组，以发票单号作为分组依据字段。\r\n2、将整个发票分解为三个区域：头、明细、尾，分别对应报表的分组头、明细网格、分组尾。\r\n3、将空白发票的扫描图作为报表设计背景图，在页面视图中插入部件框，根据背景图定位位置与确定大小。\r\n4、分组尾上的部件框不能按背景图定位\r\n5、设定合适的综合文字框的“字间距”属性值让文字输出到正确金额位栏中。\r\n6、设置综合文字框前加“*”文字实现圆圈中画叉图形的输出。\r\n7、在金额大写综合文字框上写脚本，当金额达到最高位时，不显示最前面的圈叉符号。'
	AlignToGrid=F
	Object Font
		Name='宋体'
		Size=105000,0
		Weight=400
		Charset=134
	End
	BackImagePreview=T
	Object Printer
		Size=256
		Width=18.2
		Height=11
		LeftMargin=0
		TopMargin=0
		RightMargin=0
		BottomMargin=0
	End
	Object DetailGrid
		ShowColLine=F
		ShowRowLine=F
		AppendBlankRow=T
		Object Border
			Styles=[]
			Object Pen
				Width=0
			End
		End
		Object ColLine
			Color=00646F71
		End
		Object RowLine
			Color=00646F71
		End
		Object Recordset
			ConnectionString='Provider=Microsoft.Jet.OLEDB.4.0;\r\nUser ID=Admin;\r\nData Source=..\\Data\\Northwind.mdb'
			QuerySQL='select m.OrderID,m.CustomerId,c.CompanyName,C.Address,m.OrderDate,c.ContactName+c.Phone as Remark,\r\nd.ProductID,p.ProductName,d.UnitPrice,d.Quantity,d.UnitPrice*d.Quantity*100 as Amount\r\nfrom (Orders m inner join (OrderDetails d inner join Products p on p.ProductID=d.ProductID)\r\non d.OrderID=m.OrderID) left join Customers c on c.CustomerID=m.CustomerID\r\nwhere m.OrderID>=10255 and m.OrderID<10260\r\norder by  m.OrderID'
			Items Field
				Item
					Name='ProductID'
					Type=Integer
				End
				Item
					Name='ProductName'
				End
				Item
					Name='UnitPrice'
					Type=Float
					Format='#,##0.##'
				End
				Item
					Name='Quantity'
					Type=Integer
					Format='#,##0.##'
				End
				Item
					Name='Discount'
					Type=Float
					Format='0.00%'
				End
				Item
					Name='Amount'
					Type=Float
					Format='$#,##0.00'
				End
				Item
					Name='OrderID'
					Type=Integer
				End
				Item
					Name='CustomerId'
				End
				Item
					Name='CompanyName'
				End
				Item
					Name='Address'
				End
				Item
					Name='OrderDate'
					Type=DateTime
				End
				Item
					Name='Remark'
				End
			End
		End
		Items Column
			Item
				Name='UnitPriceaaa'
				Width=0.75
			End
			Item
				Name='UnitPrice'
				Width=6.6675
			End
			Item
				Name='Quantity'
				Width=1.24354
			End
			Item
				Name='Discount'
				Width=1.08479
			End
			Item
				Name='Amount'
				Width=1.16417
			End
			Item
				Name='DisCountAmt'
				Width=2.27542
			End
			Item
				Name='NetAmount'
				Width=0.714375
			End
			Item
				Name='Column1'
				Width=3.28083
			End
		End
		Object ColumnContent
			Height=0.82
			AdjustRowHeight=F
			RowsPerPage=5
			Items ColumnContentCell
				Item
					Column='UnitPriceaaa'
				End
				Item
					Column='UnitPrice'
					DataField='ProductName'
				End
				Item
					Column='Quantity'
					TextAlign=MiddleRight
				End
				Item
					Column='Discount'
				End
				Item
					Column='Amount'
					TextAlign=MiddleRight
					DataField='Quantity'
				End
				Item
					Column='DisCountAmt'
					TextAlign=MiddleRight
					DataField='UnitPrice'
				End
				Item
					Column='NetAmount'
					TextAlign=MiddleRight
				End
				Item
					Column='Column1'
					FreeCell=T
					Items Control
						Item
							Type=MemoBox
							Name='MemoBox1'
							Dock=Fill
							TextAlign=MiddleRight
							CharSpacing=9
							Text='[#Amount*100:0#]'
						End
					End
				End
			End
		End
		Object ColumnTitle
			Height=1.01
			RepeatStyle=OnGroupHeader
			Items ColumnTitleCell
				Item
					GroupTitle=F
					Column='UnitPriceaaa'
				End
				Item
					GroupTitle=F
					Column='UnitPrice'
				End
				Item
					GroupTitle=F
					Column='Quantity'
				End
				Item
					GroupTitle=F
					Column='Discount'
				End
				Item
					GroupTitle=F
					Column='Amount'
				End
				Item
					GroupTitle=F
					Column='DisCountAmt'
				End
				Item
					GroupTitle=F
					Column='NetAmount'
				End
				Item
					GroupTitle=F
					Column='Column1'
				End
			End
		End
		Items Group
			Item
				Name='Group1'
				ByFields='OrderID'
				Object GroupHeader
					Height=3.2
					Items Control
						Item
							Type=MemoBox
							Name='MemoBox4'
							Left=12.4883
							Top=2.67229
							Width=1.37583
							Height=0.555625
							TextAlign=MiddleRight
							Text='[#OrderDate:yyyy#]'
						End
						Item
							Type=MemoBox
							Name='MemoBox5'
							Left=14.314
							Top=2.67229
							Width=0.846667
							Height=0.555625
							TextAlign=MiddleRight
							Text='[#OrderDate:M#]'
						End
						Item
							Type=MemoBox
							Name='MemoBox6'
							Left=15.5575
							Top=2.67229
							Width=0.846667
							Height=0.555625
							TextAlign=MiddleRight
							Text='[#OrderDate:d#]'
						End
						Item
							Type=FieldBox
							Name='FieldBox2'
							Left=2.61938
							Top=2.54
							Width=4.78896
							Height=0.582083
							DataField='Address'
						End
						Item
							Type=Barcode
							Name='Barcode17'
							Left=7.64646
							Top=0.105833
							Width=4.33917
							Height=2.96333
							BarcodeType=QRCode
							CaptionPosition=None
							CheckSum=T
							Text='[#Sum(Amount)*100:0#]'
							Object Font
								Name='宋体'
								Size=142500,0
								Weight=400
								Charset=134
							End
						End
					End
				End
				Object GroupFooter
					Height=2.14313
					NewPage=After
					Items Control
						Item
							Type=MemoBox
							Name='MemoBox2'
							Left=4.02167
							Top=0.0264583
							Width=8.62542
							Height=0.873125
							Object Font
								Name='宋体'
								Size=105000,0
								Bold=T
								Charset=134
							End
							TextAlign=MiddleRight
							CharSpacing=28
							GetDisplayTextScript='//当金额达到最高位时，将显示文字的最前面“*”字符去掉，实现不显示最前面的圈叉符号\r\nvar str = Sender.DisplayText;\r\nif (str.length > 8)\r\n  Sender.DisplayText = str.substr(1);'
							Text='*[#Sum(Amount):$$$$#.00#]'
						End
						Item
							Type=MemoBox
							Name='MemoBox3'
							Left=13.9435
							Top=0.15875
							Width=3.22792
							Height=0.635
							TextAlign=MiddleRight
							CharSpacing=9
							Text='[#Sum(Amount)*100:0#]'
						End
						Item
							Type=FieldBox
							Name='FieldBox3'
							Left=2.59292
							Top=1.29646
							Width=14.5785
							Height=0.5
							DataField='Remark'
						End
					End
				End
			End
		End
	End
End
